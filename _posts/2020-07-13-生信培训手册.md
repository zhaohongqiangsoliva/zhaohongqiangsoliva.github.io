---
layout:     post
title:      生信培训手册
subtitle:   生信培训手册
date:       2020-07-13
author:     soliva
header-img: img/post-bg-ios9-web.jpg
catalog: 	 true
tags:
    - 生信
---
[toc]
# 前言
## 软件安装
数据库下载
软件安装
### R 
```
#yum install gcc-gfortran              #否则报”configure: error: No F77 compiler found”错误

#yum install gcc gcc-c++              #否则报”configure: error: C++ preprocessor “/lib/cpp” fails sanity check”错误

#yum install readline-devel          #否则报”–with-readline=yes (default) and headers/libs are not available”错误

#yum install libXt-devel                 #否则报”configure: error: –with-x=yes (default) and X11 headers/libs are not available”错误

```
```
然后下载源代码,编译

yum install R 
yum install shiny
wget https://download3.rstudio.org/centos6.3/x86_64/shiny-server-1.5.14.948-x86_64.rpm
sudo yum install --nogpgcheck shiny-server-1.5.14.948-x86_64.rpm
即可完成编译安装。
```




# 1.入门linux
    第1阶段：把linux系统玩得跟Windows或者MacOS那样的桌面操作系统一样顺畅，主要目的就是去可视化，熟悉黑白命令行界面，可以仅仅以键盘交互模式完成常规文件夹及文件管理工作。
    第2阶段：做到文本文件的表格化处理，类似于以键盘交互模式完成Excel表格的排序、计数、筛选、去冗余，查找，切割，替换，合并，补齐，熟练掌握awk,sed,grep这文本处理的三驾马车。
    第3阶段：元字符，通配符及shell中的各种扩展，从此linux操作不在神秘！
    第4阶段：高级目录管理：软硬链接，绝对路径和相对路径，环境变量
    第5阶段：任务提交及批处理，脚本编写解放你的双手
    第6阶段：软件安装及conda管理，让linux系统实用性放飞自我

## 1.常规文件夹及文件管理工作
```
ls ## list 列出当前路径下信息
pwd ## print working directory 打印工作目录，即当前所在目录
cd ## change directory 切换目录
mkdir ## make directory建立一个新的目录
touch ## 创建文本
mv ## Move 更改文件或目录，移动目录或文件
rm ## ReMove 删除目录或文件
cp ## copy and paste 将给出的文件或目录复制到另一个文件或目录中 tar ## Tape archive 解压文件
ln ## LINk 链接文件
```
## 2.文本文件处理
```
head # 功能:显示文档的开头至标准输出中，默认显示十行。
tail # 功能:显示文档的末尾至标准输出中，默认显示十行。
less  # 功能:逐页查看文档内容。
more # 也是逐页查看文档内容，跟less类似
cat # cat 命令 (concatenate) 查看文本，输出到屏幕
```
# DNA测序
#### 基本流程
fastq->bam->vcf->maf->各种高级分析结果

#### 文件格式：

- fastq

第一行：以‘@’开头，是这一条read的名字，这个字符串是根据测序时的状态信息转换过来的，中间不会有空格，它是每一条read的唯一标识符，同一份FASTQ文件中不会重复出现，甚至不同的FASTQ文件里也不会有重复；

第二行：测序read的序列，由A，C，G，T和N这五种字母构成，这也是我们真正关心的DNA序列，N代表的是测序时那些无法被识别出来的碱基；

第三行：以‘+’开头，在旧版的FASTQ文件中会直接重复第一行的信息，但现在一般什么也不加（节省存储空间）；

第四行：测序read的质量值，这个和第二行的碱基信息一样重要，它描述的是每个测序碱基的可靠程度，用ASCII码表示。
```
@FCD056DACXX:3:1101:2163:1959#TCGCCGTG/1
TCCGATAACGCTCAACCAGAGGGCTGCCAGCTCCGATCGGCAGTTGCAACCCATTGGCCGTCTGAGCCAGCAACCCCGGA
+
gggiiiiiiiiiiiiiiiiiiiiiiiiiigggggeeecccccc^bcbcccccccbccccc]aaccbbccc^R^^acccc_
```
- bam
```
FCC1L2FACXX:3:2106:15923:93264	99	1	1073	0	100M	=	1461	488 TGTGAAGGCCCCCTGCTCTGACTGTGTTAGTGTCCATTTCTCCTTTTACGGTTGTAGCAGTTGCCTTCTACATTGCGGGGATCCTGTATTGGGTGCATGT ___eceeegfggggdgiiifghii[degfhfgfdffhhhfhfghiiighiiH^`Vbgfffihhiiiihhddbdgfgccca][^bbbbbccbca[X^Y_b_ MD:Z:98A1	PG:Z:MarkDuplicatesRG:Z:SRR949625	NM:i:1	AS:i:98	XS:i:98
FCC1L2FACXX:3:2111:13731:89147	163	1	1073	7	100M	=	1438	465 TGTGAAGGCCCCGTGCTCTGACTGTGTTAGTGTCCATTTCTCCTTTTACGGTTGTAGCAGTTGCCTTCTACATTGCGGGGATCCTGTATTGGGTGCATAT bbaeeeeefggggefhiiiihiiicgghhigdehhhiiihiieffhiihihbggdghihfgffhihihf`geed_cecac]accb]_bcccbc^a_bcbb MD:Z:12C87	PG:Z:MarkDuplicatesRG:Z:SRR949625	NM:i:1	AS:i:95	XS:i:95
```

- vcf
```
1.什么是vcf文件
VCF是用于描述SNP（单个碱基上的变异），INDEL（插入缺失标记）和SV（结构变异位点）结果的文本文件。在GATK软件中得到最好的支持，当然SAMtools得到的结果也是VCF格式，和GATK的CVF格式有点差别。

2.VCF的主体结构
##fileformat=VCFv4.2
##fileDate=20090805
##source=myImputationProgramV3.1
##reference=file:///seq/references/1000GenomesPilot-NCBI36.fasta
##contig=<ID=20,length=62435964,assembly=B36,md5=f126cdf8a6e0c7f379d618ff66beb2da,species="Homo sapiens",taxonomy=x>
##phasing=partial
##INFO=<ID=NS,Number=1,Type=Integer,Description="Number of Samples With Data">
##INFO=<ID=DP,Number=1,Type=Integer,Description="Total Depth">
##INFO=<ID=AF,Number=A,Type=Float,Description="Allele Frequency">
##INFO=<ID=AA,Number=1,Type=String,Description="Ancestral Allele">
##INFO=<ID=DB,Number=0,Type=Flag,Description="dbSNP membership, build 129">
##INFO=<ID=H2,Number=0,Type=Flag,Description="HapMap2 membership">
##FILTER=<ID=q10,Description="Quality below 10">
##FILTER=<ID=s50,Description="Less than 50% of samples have data">
##FORMAT=<ID=GT,Number=1,Type=String,Description="Genotype">
##FORMAT=<ID=GQ,Number=1,Type=Integer,Description="Genotype Quality">
##FORMAT=<ID=DP,Number=1,Type=Integer,Description="Read Depth">
##FORMAT=<ID=HQ,Number=2,Type=Integer,Description="Haplotype Quality">
#CHROM POS     ID        REF    ALT     QUAL FILTER INFO                              FORMAT      NA00001        NA00002        NA00003
    14370   rs6054257 G      A       29   PASS   NS=3;DP=14;AF=0.5;DB;H2           GT:GQ:DP:HQ 0|0:48:1:51,51 1|0:48:8:51,51 1/1:43:5:.,.
    17330   .         T      A       3    q10    NS=3;DP=11;AF=0.017               GT:GQ:DP:HQ 0|0:49:3:58,50 0|1:3:5:65,3   0/0:41:3
    1110696 rs6040355 A      G,T     67   PASS   NS=2;DP=10;AF=0.333,0.667;AA=T;DB GT:GQ:DP:HQ 1|2:21:6:23,27 2|1:2:0:18,2   2/2:35:4
    1230237 .         T      .       47   PASS   NS=3;DP=13;AA=T                   GT:GQ:DP:HQ 0|0:54:7:56,60 0|0:48:4:51,51 0/0:61:2
    1234567 microsat1 GTC    G,GTCT  50   PASS   NS=3;DP=9;AA=G                    GT:GQ:DP    0/1:35:4      
```
- maf

![1597303156981.png](/img/bioinfo_teaching/1597303156981.png)

# RNAseq
#### 软件安装
```
conda create -p ./envs -c bioconda sra-tools
conda install fastqc
conda install hisat2
conda install samtools
samtools  -help
```

### 什么是RNA seq

#### reads Count
定义：高通量测序中比对到exon上的reads数。
#### RPKM/FPKM
定义：RPKM: Reads Per Kilobase of exon model per Million mapped reads (每千个碱基的转录每百万映射读取的reads)；FPKM: Fragments Per Kilobase of exon model per Million mapped fragments(每千个碱基的转录每百万映射读取的fragments)
公式：RPKM = (ExonMappedReads * 10^9 ) / (TotalMappedReads * ExonLength)

![1597198673271.png](/img/bioinfo_teaching/1597198673271.png)

#### 数据下载
```
GEO 数据库
连接：https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE52778
了解数据
然后熟悉如何寻找数据
https://bigd.big.ac.cn/?lang=zh
找到数据后下载
sra-tools -> prefetch
prefetch --option-file  SRR_Acc_List.txt

```

# 单细胞



# 统计学
## 统计学基础
https://blog.csdn.net/qq_41909309/article/details/103595682
- 文氏图

![1597200341165.png](/img/bioinfo_teaching/1597200341165.png)

- 热图

![1597200355169.png](/img/bioinfo_teaching/1597200355169.png)

图示解释：
聚类热图包含两个数据轴的信息，一个轴表示不同的实验处理条件/样本（如图中横轴），另一个轴表示不同的基因（如图中纵轴）根据聚类分析可以将不同样本中表达模式相同或相似的基因聚为一类。表达模式相似的基因可能具有相似的功能，共同参与同一代谢过程或存在于同一细胞通路中，因此，将表达模式相同或相近的基因聚集成类，可以用于推测未知基因的功能或已知基因的新功能。
红色：表示基因表达水平高；蓝色：表示基因表达水平低。
聚类方式：双向聚类（如上图）可以根据某一基因在不同样本中的表达水平将样本聚类，同时可以根据某一样本中不同基因的表达水平将基因进行聚类。另有横向/纵向聚类、无向聚类。
- 折线图
- hist plot

![1597208385052.png](/img/bioinfo_teaching/1597208385052.png)

- 火山图

![1597200095269.png](/img/bioinfo_teaching/1597200095269.png)

火山图，是形如火山喷发的一种图形展示方法，常被用于展示差异，比如差异基因、差异微生物等等。
上图就是一张典型的火山图，描述了差异基因的情况。该火山图的y轴是-log10(Qvalue)，即qvalue（pvalue校正后的值）取-log10，因此数值越高说明qvalue越小即越显著。横坐标是Log2 fold change，即对fold change取log2，所以越靠两侧的点（每个点代表一个基因），其基因表达量上调或者下调幅度越大。
一般来说在差异基因分析过程中，我们通常认为qvalue小于0.05且foldchange的绝对值大于2为差异基因。当然在差异基因数量过多的时候，我们可以调整筛选标准以获得相对适合数量的差异基因再进行下游的富集分析，比如要求qvalue小于0.001，或者要求foldchange的绝对值大于5等等。当差异基因数量过少的时候，我们可以考虑将foldchange的绝对值变为1.5，或者考虑选择pvalue小于0.05。
而图中的虚线就是根据自己的筛选标准确定添加。其中两条竖线（x=-2和x=2）说明该筛选标准是要求foldchange的绝对值大于4。横线（大胆猜测是在y=2处），说明要求qvalue小于0.01。
当Foldchange没有那么明显的时候，我们的横轴也可以选择展示Foldchange，不取log2。


## PCA 
https://www.cnblogs.com/zkkaka/p/6160963.html
https://www.cnblogs.com/leezx/p/6120302.html
## K-means


## 如何使用这些方法：
文章案例

Identification of a novel biomarker, SEMA5A, for non-small cell lung carcinoma in nonsmoking women

相关基因：SEMA5A

相关疾病 ：Carcinoma, Non-Small-Cell Lung;Lung Neoplasms

PMID: 20802022 影响因子3.622 GEO 相关样本：120

文章作者使用Affymetrix U133plus2.0芯片1检测了台湾地区非吸烟肺癌女性患者60对癌症和癌旁肺组织样本，利用配对T检验筛选了肿瘤组织中687个差异表达基因，并且利用逆转录PCR和免疫组化进行了验证。

如何将687个缩小范围呢?

因此我们需要判断差异基因在肺癌细胞中主要富集在哪些功能类群和代谢通路。文章作者利用IPA(Ingenuity Pathway Analysis)软件对差异基因进行了功能分析，筛选出了16条显著性代谢通路。在最显著改变的三条通路中，其中两条都和轴突导向信号通路(axon guidance)相关，作者很意外，于是就选定了轴突导向信号通路，并在其中挑选了差异表达倍数最高的SEMA5A基因作为后续的研究对象。

作者最后利用kaplan-Meier生存分析证明了SEMA5A基因的低表达和非吸烟女性肺癌的低生存率有关联，其可能成为非小细胞肺癌预后的一个有效的生物标志物，也可能代表台湾地区病人的性别特异性。

归纳一下作者的整体思路，先找差异基因，并通过功能分析进一步缩小差异基因的范围，再从中有针对性的挑选基因。


![1597201078786.png](/img/bioinfo_teaching/1597201078786.png)

GO

GO是Gene ontology的缩写，GO数据库分别从功能、参与的生物途径及细胞中的定位对基因产物进行了标准化描述，即对基因产物进行简单注释，通过GO富集分析可以粗略了解差异基因富集在哪些生物学功能、途径或者细胞定位。

Pathway

Pathway指代谢通路，对差异基因进行pathway分析，可以了解实验条件下显著改变的代谢通路，在机制研究中显得尤为重要。

GO分析好比是将基因分门别类放入一个个功能类群的篮子，而pathway则是将基因一个个具体放到代谢网络中的指定位置。

文章分析结果

小编利用上述案例中的数据GSE19804在GCBI在线实验室首先进行差异分析(|fold change|>2, P值<0.001 Q值<0.05)，得到了2202个差异基因。将差异基因分别进行GO(P值<0.01，FDR<0.01)和pathway分析(P值<0.05)，富集得到351个GO term和110条pathway。结果如下图所示，表一和表二分别为部分GO富集结果和最显著的15条pathway分析结果。

![1597201247043.png](/img/bioinfo_teaching/1597201247043.png)


![1597201255312.png](/img/bioinfo_teaching/1597201255312.png)


结果怎么看呢?

表头各个参数的解释如下，其中，重点看三个指标， enrichment score、p值和FDR。Pathway分析主要看P值和FDR值，两者越小越好。GO分析还可看enrichment score，数值越大表示某个GO term越容易受到实验因素的影响。


![1597201269271.png](/img/bioinfo_teaching/1597201269271.png)


GO和pathway分析结果中都得到了文章中选定的axon guidance这个结果(红框)。



Ps：因参数设置和文章中不同，结果仅供参考。